# 開発ルール / Development Rules

## 🚫 禁止事項 / Prohibited Actions

### 開発サーバーの自動起動禁止

- **絶対に勝手に開発サーバーを起動しないこと**
- `npm run dev`, `yarn start`, `make dev-all` などの長時間実行コマンドは実行しない
- `controlBashProcess` ツールでの開発サーバー起動も禁止
- ユーザーが手動で起動したプロセスと競合する可能性があるため

### モックデータの使用禁止

- **実際の API エラーを隠すモックデータの使用は禁止**
- バックエンドエラーが発生した場合、モックデータで隠さずに実際のエラーを表示すること
- デバッグとトラブルシューティングのため、実際の API 通信状況を把握する必要がある
- モックデータは開発初期段階でのみ使用し、API 実装後は無効にすること

### モック機能実装時の環境切り替え要件

- **モック機能を実装する場合は、必ず開発環境と本番環境で切り替え可能にすること**
- 環境変数（`NODE_ENV`、`ENVIRONMENT`等）を使用して動的に切り替える仕組みを実装
- 本番環境では実際のサービス（AWS Cognito、外部 API 等）を使用するよう設定
- 開発環境でのみモック機能を有効化し、本番デプロイ時に自動的に実サービスに切り替わるようにする
- モック実装時は以下のパターンを使用：
  ```javascript
  const isDevelopment = process.env.NODE_ENV === "development";
  if (isDevelopment) {
    // モック処理
  } else {
    // 実際のサービス処理
  }
  ```

### 完全ローカル仕様の実装禁止

- **完全にローカル環境専用の実装は禁止**
- 設定やコードを変更する際は、必ず本番環境での動作も考慮すること
- ローカル開発用の設定を追加する場合は、環境変数による条件分岐を使用
- 本番環境で動作しない設定や実装は避けること
- 例：認証設定、API エンドポイント、データベース接続等

### 理由

- プロセスの競合によりポートが使用できなくなる
- デバッグ作業が遅延する
- 既存の開発環境を破壊する可能性がある
- **実際のエラーが隠蔽され、問題の根本原因が特定できなくなる**
- **完全モック仕様では本番環境での動作確認ができず、デプロイ時に予期しない問題が発生する**
- **完全ローカル仕様の実装により、本番環境でのデプロイや動作に支障をきたす**

## ✅ 許可されている操作 / Allowed Operations

### テスト実行

- `npm test -- --run` (単発実行)
- `make test-frontend`
- `make test-backend`

### ビルド・型チェック

- `npm run build`
- `npm run type-check`
- `npm run lint`

### 短時間で完了するコマンド

- ファイル操作
- 設定変更
- 依存関係のインストール

## 📝 開発サーバー起動について

開発サーバーの起動は**必ずユーザーが手動で行う**こと：

```bash
# ユーザーが実行すべきコマンド
make dev-all          # 全サービス起動
make dev-frontend     # フロントエンドのみ
make dev-backend      # バックエンドのみ
```

## 🔧 AI アシスタントの役割

- コードの実装・修正
- テストの実行と結果確認
- 設定ファイルの更新
- ドキュメントの作成・更新
- **開発サーバーの起動は絶対に行わない**
- **実際の API エラーを隠すモックデータの実装は行わない**
- **モック機能実装時は必ず環境切り替え機能を含める**
- **完全にローカル環境専用の実装は行わない（本番環境での動作を常に考慮する）**

---

**このルールは必ず遵守すること。違反した場合は即座に作業を停止すること。**
