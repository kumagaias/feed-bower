# Feed Bower - 要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名

Feed Bower（フィードバウアー）

### 1.2 目的

AI が見つける、ユーザーだけのパーソナライズされた RSS フィード体験を提供する Web アプリケーション。キーワードベースでフィードを整理し、鳥の巣（Bower）のように情報を育てる。

### 1.3 ターゲットユーザー

- 情報収集を効率化したい技術者・ビジネスパーソン
- 複数の情報源を一元管理したいユーザー
- 興味のある分野ごとに情報を整理したいユーザー

---

## 2. システム構成

### 2.1 プロジェクト構造

```
feed-bower/
├── back/                      # バックエンド
│   └── go/                    # Go言語実装
│       ├── lambda/            # AWS Lambda関数
│       └── Dockerfile         # ECRコンテナイメージ
├── front/                     # フロントエンド
│   └── next.js/               # Next.js 14アプリケーション
├── infra/                     # インフラストラクチャ
│   └── terraform/             # Terraform IaCコード
└── prototype/                 # プロトタイプ（現在の実装）
```

### 2.2 技術スタック

#### 2.2.1 フロントエンド

- **フレームワーク**: Next.js 15 (App Router)
- **言語**: TypeScript
- **UI ライブラリ**: React 18
- **スタイリング**: Tailwind CSS
- **状態管理**: React Context API
- **ストレージ**: localStorage（プロトタイプ）→ API 連携（本番）

#### 2.2.2 バックエンド

- **言語**: Go
- **実行環境**: AWS Lambda
- **コンテナ**: Docker (ECR)
- **API**: REST API
- **認証**: JWT（予定）

#### 2.2.3 インフラストラクチャ

- **IaC**: Terraform
- **クラウド**: AWS
  - Lambda（バックエンド実行）
  - ECR（コンテナレジストリ）
  - API Gateway（API エンドポイント）
  - DynamoDB（データベース、予定）
  - S3（静的ファイル、予定）
  - CloudFront（CDN、予定）
- **CI/CD**: GitHub Actions（予定）

### 2.3 カラーパレット

```typescript
primary: "#14b8a6"; // Bright teal（メインカラー）
secondary: "#0f766e"; // Dark teal（サブカラー）
accent: "#f59e0b"; // Amber（アクセント）
tertiary: "#505050"; // Dark gray（区切り線・ボーダー）
background: "#f0fdf4"; // Very light green（背景）
```

---

## 3. 機能要件

### 3.1 認証・ユーザー管理

#### 3.1.1 ログイン機能
- **メールアドレスログイン**: メールアドレスとパスワードでログイン
- **新規登録**: メールアドレスとパスワードでアカウント作成
- **ログアウト**: セッション終了
- **パスワードリセット**: メールでのパスワードリセット（将来実装）
- **Google ログイン**: Google OAuth（将来実装）

#### 3.1.2 言語切り替え

- 日本語/英語の切り替え
- ユーザー設定として保持

---

### 3.2 バウアー（Bower）管理機能

#### 3.2.1 バウアーとは

- キーワードベースでフィードを整理する単位
- 1 つのバウアーに複数のキーワードとフィードを紐付け
- 鳥の巣のメタファーで情報を育てる

#### 3.2.2 バウアー作成

**入力項目**:

- バウアー名（必須）
- キーワード（最大 8 個）
  - ドラッグ&ドロップで巣に追加
  - 重複チェック
  - 削除可能

**バウアー名の自動生成**:

- キーワードから自動的にバウアー名を生成
- 例: 「AI, プログラミング, 機械学習」→「AI・プログラミング」

**作成フロー**:

1. キーワード入力画面
2. プレビュー画面（AI がフィードを提案）
3. フィード選択・追加
4. 完了

#### 3.2.3 バウアー編集

- バウアー名の変更
- キーワードの追加・削除
- フィードの追加・削除
- 公開/非公開設定
- 保存ボタンを押すまで変更を反映しない

#### 3.2.4 バウアー削除

- 確認モーダル表示
- 削除後は元に戻せない警告

#### 3.2.5 バウアー一覧

- マイバウアー表示
- プリセットバウアー表示（将来実装）
- 検索機能
- カード形式で表示
  - バウアー名
  - キーワード数
  - フィード数
  - 公開/非公開ステータス

---

### 3.3 フィード管理機能

#### 3.3.1 フィード追加

- URL 入力（http/https 必須、ドット必須）
- バリデーション
  - 有効な URL 形式チェック
  - 重複チェック
- URL 未入力時は追加ボタン無効化
- 最低 1 つのフィードは必須（最後のフィードは削除不可）

#### 3.3.2 フィードプレビュー

- モーダル形式で表示
- 記事一覧のプレビュー
- ローディング表示（🐣 アイコン）

#### 3.3.3 フィード削除

- 最後の 1 つは削除不可
- 削除ボタンを非表示

---

### 3.4 記事表示・管理機能

#### 3.4.1 記事一覧表示

**レイアウト**:

- カード形式
- 画像（左側、128px × 96px）
- コンテンツ（右側）
  - バウアーバッジ
  - 公開日
  - タイトル（2 行まで）
  - 本文プレビュー（2 行まで）
  - 「続きを読む」リンク
  - いいねボタン

**表示件数**:

- 初回 50 件
- 無限スクロールで 50 件ずつ追加読み込み
- ローディング表示（🐣 アイコン + バウンドアニメーション）

#### 3.4.2 タブ機能

- **すべて**: 全記事表示
- **重要**: 重要記事のみ（将来実装）
- **お気に入り**: いいねした記事のみ

#### 3.4.3 日付グループ化

**表示条件**:

- 「すべて」タブとバウアー別表示時のみ
- 「重要」「お気に入り」タブでは非表示

**機能**:

- 日付ごとにグループ化
- トグルで開閉
- チェックボタンで一括既読
- 「全て開く/閉じる」ボタン（最初の日付と同じライン）

**日付トグルの色**:

- 未チェック: primary 色（#14b8a6）
- チェック済: tertiary 色（#505050）

#### 3.4.4 チェック機能

**日付単位のチェック**:

- チェックマーク（✓）アイコン
- 未チェック: primary 色
- チェック済: tertiary 色
- クリックでトグル

**チェック済記事の表示**:

- 透明度 70%
- 「チェック済 ✕」バッジ表示
- バッジクリックでチェック解除

**経験値システム**:

- 初回チェック時のみ+1p
- 再チェック時は加算なし
- localStorage に履歴を永続保存

#### 3.4.5 いいね機能

- ハートアイコン（❤️/🤍）
- いいね時: +1p 経験値
- いいね解除時: -1p 経験値
- お気に入りタブに表示

#### 3.4.6 記事閲覧

- クリックで外部リンクを新規タブで開く
- 自動的にチェック済にマーク
- localStorage に保存

#### 3.4.7 検索機能

- タイトル・本文での検索
- リアルタイム検索
- クリアボタン

#### 3.4.8 バウアー切り替え

- プルダウンで選択
- 選択したバウアーの記事のみ表示

---

### 3.5 ひよこ育成システム

#### 3.5.1 ひよこアイコン

**表示位置**: 画面右下固定

**アニメーション**:

- いいね時: ジャンプアニメーション（2 回）
- チェック時: ジャンプアニメーション（2 回）
- レベルアップ時: 回転＆拡大アニメーション + トースト通知

**成長段階**:

- レベル 1-4: 🐣（ひよこ）
- レベル 5-9: 🐤（少し成長）
- レベル 10-19: 🐥（さらに成長）
- レベル 20 以上: 🐦（成鳥）

#### 3.5.2 ステータス表示

**モーダル内容**:

- タブ切り替え
  - **お気に入り**: いいねした記事一覧
  - **ステータス**: 統計情報

**ステータス項目**:

- 総いいね数
- チェックした日数
- 経験値 / 次のレベルまで
- プログレスバー

**経験値計算**:

- いいね: +1p
- 日付チェック（初回のみ）: +1p
- レベルアップ: 10p ごと

#### 3.5.3 デバッグコマンド

```javascript
chickDebug.testJump(); // ジャンプアニメーションテスト
chickDebug.testLevelUp(); // レベルアップアニメーションテスト
chickDebug.addLikes(count); // いいね数追加
chickDebug.setLevel(level); // レベル設定
chickDebug.reset(); // ステータスリセット
chickDebug.help(); // ヘルプ表示
```

---

### 3.6 多言語対応

#### 3.6.1 対応言語

- 日本語（デフォルト）
- 英語

#### 3.6.2 翻訳管理

- `src/lib/i18n.ts`で一元管理
- 全ての UI テキストを翻訳キーで管理

#### 3.6.3 翻訳対象

- ナビゲーション
- ボタン・ラベル
- メッセージ
- エラーメッセージ
- プレースホルダー

---

## 4. 非機能要件

### 4.1 パフォーマンス

- 初回ロード: 3 秒以内
- 無限スクロール: 1 秒以内に次の 50 件を表示
- アニメーション: 60fps 維持

### 4.2 レスポンシブデザイン

- デスクトップ（768px 以上）
  - サイドバーナビゲーション
  - 固定ヘッダー
- モバイル（768px 未満）
  - ボトムナビゲーション
  - ハンバーガーメニュー

### 4.3 ブラウザ対応

- Chrome（最新版）
- Firefox（最新版）
- Safari（最新版）
- Edge（最新版）

### 4.4 アクセシビリティ

- キーボード操作対応
- スクリーンリーダー対応
- カラーコントラスト比準拠（WCAG AA）

---

## 5. データ構造

### 5.1 Bower（バウアー）

```typescript
interface Bower {
  id: string;
  name: string;
  keywords: string[];
  feeds: Feed[];
  color: string;
  createdAt: Date;
  isPublic: boolean;
  creatorId?: string;
  creatorName?: string;
  likes?: number;
  likedBy?: string[];
}
```

### 5.2 Feed（フィード）

```typescript
interface Feed {
  id: string;
  title: string;
  url: string;
  description: string;
  category: string;
  lastUpdated: Date;
}
```

### 5.3 Article（記事）

```typescript
interface Article {
  id: string;
  feedId: string;
  title: string;
  content: string;
  url: string;
  publishedAt: Date;
  liked: boolean;
  bower: string;
  read: boolean;
  image?: string;
}
```

### 5.4 User（ユーザー）

```typescript
interface User {
  id: string;
  email: string;
  name: string;
}
```

### 5.5 ChickStats（ひよこステータス）

```typescript
interface ChickStats {
  totalLikes: number;
  level: number;
  experience: number;
  nextLevelExp: number;
  checkedDays: number;
}
```

### 5.6 LikedArticle（お気に入り記事）

```typescript
interface LikedArticle {
  id: string;
  title: string;
  url: string;
  likedAt: Date;
  bower?: string;
}
```

---

## 6. ストレージ設計（localStorage）

### 6.1 保存データ

```typescript
// 既読記事ID配列
readArticles: string[]

// チェック済日付履歴（永続）
checkedDatesHistory: string[]

// ユーザー設定
userSettings: {
  language: 'ja' | 'en'
}

// ひよこステータス
chickStats: ChickStats

// お気に入り記事
likedArticles: LikedArticle[]

// バウアー一覧
bowers: Bower[]
```

---

## 7. 画面遷移図

```
ランディングページ (/)
  ├─ ログイン → ホーム (/feeds)
  └─ 新規登録 → ホーム (/feeds)

ホーム (/feeds)
  ├─ タブ切り替え（すべて/重要/お気に入り）
  ├─ バウアー切り替え
  ├─ 記事クリック → 外部サイト（新規タブ）
  └─ ひよこクリック → ステータスモーダル

バウアー一覧 (/bowers)
  ├─ バウアー作成 → バウアー作成フロー (/bowers/new)
  ├─ バウアー編集 → バウアー編集 (/bowers/edit/[id])
  └─ バウアー削除 → 確認モーダル

バウアー作成 (/bowers/new)
  ├─ キーワード入力
  ├─ プレビュー (/bowers/preview)
  └─ 完了 → バウアー一覧

お気に入り (/liked)
  └─ いいねした記事一覧
```

---

## 8. UI/UX ガイドライン

### 8.1 デザイン原則

1. **シンプル**: 情報過多を避け、必要な情報のみ表示
2. **直感的**: アイコンとラベルで操作を明確に
3. **フィードバック**: アクションに対して即座に反応
4. **一貫性**: 全画面で統一されたデザイン言語

### 8.2 アニメーション

- **ローディング**: 🐣 アイコンのバウンド
- **ホバー**: shadow-xl、scale-110
- **トランジション**: 0.3 秒のイージング
- **ひよこ**: ジャンプ（1.2 秒）、レベルアップ（2 秒）

### 8.3 フィードバック

- **成功**: トーストメッセージ（緑）
- **エラー**: 赤文字のメッセージ
- **ローディング**: 🐣 アイコン + テキスト
- **確認**: モーダルダイアログ

---

## 9. 今後の拡張機能

### 9.1 フェーズ 2（短期）

- [ ] 実際の RSS フィード取得
- [ ] AI によるフィード推薦
- [ ] 記事の自動要約
- [ ] 通知機能
- [ ] オフライン対応（PWA）

### 9.2 フェーズ 3（中期）

- [ ] バックエンド API 構築
- [ ] データベース導入
- [ ] ユーザー認証（OAuth）
- [ ] バウアーの共有機能
- [ ] コミュニティ機能

### 9.3 フェーズ 4（長期）

- [ ] モバイルアプリ（React Native）
- [ ] ブラウザ拡張機能
- [ ] AI チャットボット
- [ ] 記事の自動分類
- [ ] レコメンデーションエンジン

---

## 10. 開発ガイドライン

### 10.1 コーディング規約

- **TypeScript**: 厳格な型定義
- **命名規則**: camelCase（変数・関数）、PascalCase（コンポーネント・型）
- **コンポーネント**: 単一責任の原則
- **ファイル分割**: 500 行を超えたら分割検討

### 10.2 ディレクトリ構造

#### 10.2.1 プロジェクト全体

```
feed-bower/
├── back/                      # バックエンド
│   └── go/
│       ├── cmd/               # エントリーポイント
│       ├── internal/          # 内部パッケージ
│       │   ├── handler/       # Lambda ハンドラー
│       │   ├── service/       # ビジネスロジック
│       │   ├── repository/    # データアクセス層
│       │   └── model/         # データモデル
│       ├── pkg/               # 公開パッケージ
│       ├── Dockerfile
│       └── go.mod
├── front/                     # フロントエンド
│   └── next.js/
│       ├── src/
│       │   ├── app/           # Next.js App Router
│       │   ├── components/    # コンポーネント
│       │   ├── contexts/      # Context API
│       │   ├── hooks/         # カスタムフック
│       │   ├── lib/           # ユーティリティ
│       │   ├── styles/        # スタイル
│       │   └── types/         # 型定義
│       ├── public/            # 静的ファイル
│       └── package.json
├── infra/                     # インフラストラクチャ
│   └── terraform/
│       ├── modules/           # Terraformモジュール
│       │   ├── lambda/
│       │   ├── api-gateway/
│       │   └── ecr/
│       ├── environments/      # 環境別設定
│       │   ├── dev/
│       │   ├── staging/
│       │   └── prod/
│       ├── main.tf
│       ├── variables.tf
│       └── outputs.tf
└── prototype/                 # プロトタイプ（現在の実装）
    └── src/
        ├── app/               # Next.js App Router
        ├── components/        # コンポーネント
        ├── contexts/          # Context API
        ├── hooks/             # カスタムフック
        ├── lib/               # ユーティリティ
        ├── styles/            # スタイル
        └── types/             # 型定義
```

#### 10.2.2 フロントエンド詳細（prototype/）

```
prototype/
├── src/
│   ├── app/                    # Next.js App Router
│   │   ├── page.tsx           # ランディングページ
│   │   ├── feeds/             # フィード画面
│   │   ├── bowers/            # バウアー管理
│   │   └── liked/             # お気に入り
│   ├── components/            # 共通コンポーネント
│   │   ├── Layout.tsx
│   │   ├── Sidebar.tsx
│   │   ├── MobileHeader.tsx
│   │   ├── ChickIcon.tsx
│   │   ├── ArticleCard.tsx
│   │   ├── BowerCard.tsx
│   │   └── BowerCreator.tsx
│   ├── contexts/              # Context API
│   │   └── AppContext.tsx
│   ├── hooks/                 # カスタムフック
│   │   └── useBowers.ts
│   ├── lib/                   # ユーティリティ
│   │   └── i18n.ts
│   ├── styles/                # スタイル定義
│   │   └── colors.ts
│   └── types/                 # 型定義
│       └── index.ts
```

### 10.3 テスト方針

- 次のタスクに移る前に必ず npm run test && npm run type-check && npm run lint を実行し、エラーがないことを確認すること
- **単体テスト**: Vite
- **E2E テスト**: Playwright
- **カバレッジ**: 80%以上

### 10.4 パフォーマンス最適化

- 画像の遅延読み込み
- コンポーネントのメモ化（React.memo）
- 無限スクロールの仮想化検討
- バンドルサイズの最適化

---

## 11. セキュリティ要件

### 11.1 XSS 対策

- ユーザー入力のサニタイズ
- dangerouslySetInnerHTML の使用禁止

### 11.2 CSRF 対策

- トークンベースの認証（将来実装）

### 11.3 データ保護

- localStorage の暗号化検討
- 機密情報の保存禁止

---

## 12. リリース計画

### 12.1 プロトタイプ（現在）

- ✅ 基本機能実装完了
- ✅ UI/UX 調整完了
- ✅ モックデータでの動作確認

### 12.2 MVP（Minimum Viable Product）

- [ ] 実際の RSS フィード取得
- [ ] バックエンド API
- [ ] ユーザー認証
- [ ] デプロイ（Vercel）

### 12.3 正式リリース

- [ ] 全機能実装
- [ ] テスト完了
- [ ] ドキュメント整備
- [ ] マーケティング

---

## 13. 付録

### 13.1 参考資料

- Next.js 公式ドキュメント
- Tailwind CSS 公式ドキュメント
- RSS 2.0 仕様
- Atom Feed 仕様

### 13.2 用語集

- **Bower（バウアー）**: 鳥の巣。情報を整理する単位
- **Feed（フィード）**: RSS フィードの URL
- **Article（記事）**: フィードから取得した個別の記事
- **Chick（ひよこ）**: ユーザーの活動を可視化するマスコット

---

## 変更履歴

| バージョン | 日付       | 変更内容 |
| ---------- | ---------- | -------- |
| 1.0        | 2025-10-09 | 初版作成 |

---

**作成者**: Kiro AI Assistant  
**最終更新**: 2025 年 10 月 9 日
